#!/usr/bin/env python3
import argparse
import sys
import importlib
from os import listdir, system, getcwd
from os.path import dirname, abspath, join, isfile


sys.path.append(getcwd())

if isfile("make.py"):
    make = importlib.import_module("make")
else:
    make = None


class CLIManager:
    def run(self, command, Args):

        if make is not None:
            if hasattr(make, command):
                func = getattr(make, command)
                return func(Args)

        if not hasattr(self, command):
            return print(f'Command "{command}" is not defined')

        func = getattr(self, command)

        return func(Args)

    def ls(self, Args):
        parser = argparse.ArgumentParser()
        parser.add_argument("-d", "--dir", action="store", type=str, default=".")
        args = parser.parse_args(Args)
        print(listdir(args.dir))


if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("not enough arguments")
    else:
        _, command, *Args = sys.argv

        cli = CLIManager()
        cli.run(command, Args)
